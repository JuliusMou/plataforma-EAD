{% extends "base.html" %}

{% block title %}Meu Painel - Plataforma EAD{% endblock %}

{% block content %}
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h1 class="display-6 fw-bold text-primary">Bem-vindo, {{ current_user.username }}!</h1>
            <p class="text-muted mb-0">Continue sua jornada de aprendizado.</p>
        </div>
        <div class="text-end d-none d-md-block">
            <span class="badge bg-light text-dark border p-2">
                <i class="bi bi-people-fill text-primary"></i> {{ total_users }} Membros
            </span>
            <span class="badge bg-success bg-opacity-10 text-success border border-success p-2 ms-2">
                <i class="bi bi-circle-fill small"></i> {{ online_users }} Online
            </span>
        </div>
    </div>

    <!-- Stats Cards (Optional addition for dashboard feel) -->
    <div class="row g-3 mb-4">
        <div class="col-md-4">
            <div class="card border-0 shadow-sm h-100 bg-primary text-white">
                <div class="card-body">
                    <h5 class="card-title fw-normal"><i class="bi bi-journal-check me-2"></i>Cursos Inscritos</h5>
                    <h2 class="fw-bold mb-0">{{ current_user.enrollments.count() }}</h2>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card border-0 shadow-sm h-100 bg-white">
                <div class="card-body">
                    <h5 class="card-title text-muted fw-normal"><i class="bi bi-trophy me-2 text-warning"></i>Pontuação Total</h5>
                    <h2 class="fw-bold mb-0 text-dark">{{ current_user.score }}</h2>
                </div>
            </div>
        </div>
        <div class="col-md-4">
             <div class="card border-0 shadow-sm h-100 bg-white">
                <div class="card-body">
                    <h5 class="card-title text-muted fw-normal"><i class="bi bi-chat-left-text me-2 text-info"></i>Fórum</h5>
                    <h2 class="fw-bold mb-0 text-dark">0 <small class="fs-6 text-muted">Posts</small></h2>
                </div>
            </div>
        </div>
    </div>

    <h3 class="mb-3 border-bottom pb-2">Meus Cursos</h3>

    <div class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4">
        {% if current_user.enrollments.all() %}
            {% for enrollment in current_user.enrollments %}
                <div class="col">
                    <div class="card h-100 shadow-hover border-0">
                        <div class="card-body d-flex flex-column">
                            <div class="d-flex justify-content-between mb-3">
                                <span class="badge bg-light text-secondary border">{{ enrollment.course.category }}</span>
                                <span class="text-warning"><i class="bi bi-star-fill"></i> 4.8</span> <!-- Placeholder rating -->
                            </div>
                            <h5 class="card-title fw-bold mb-3">{{ enrollment.course.title }}</h5>
                            <div class="mt-auto">
                                <div class="d-flex justify-content-between align-items-end">
                                    <div>
                                        <small class="text-muted d-block">Seu Progresso</small>
                                        <span class="fw-bold text-primary">{{ enrollment.score }} XP</span>
                                    </div>
                                    <a href="{{ url_for('main.pagina_curso', course_id=enrollment.course.id) }}" class="btn btn-primary rounded-pill btn-sm px-3">
                                        Continuar <i class="bi bi-arrow-right ms-1"></i>
                                    </a>
                                </div>
                                <div class="progress mt-3" style="height: 6px;">
                                    <div class="progress-bar" role="progressbar" style="width: 25%" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            {% endfor %}
        {% else %}
            <div class="col-12">
                <div class="p-5 text-center bg-white rounded shadow-sm border border-dashed">
                    <i class="bi bi-journal-x fs-1 text-muted mb-3"></i>
                    <h4>Nenhum curso iniciado</h4>
                    <p class="text-muted">Explore nossa biblioteca e comece a aprender hoje mesmo.</p>
                    <a href="{{ url_for('main.pagina_cursos') }}" class="btn btn-primary mt-2">Explorar Cursos</a>
                </div>
            </div>
        {% endif %}
    </div>

{% endblock %}